<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Serdar Korur">

  
  
  
    
  
  <meta name="description" content="Extended version of https://towardsdatascience.com/an-accidental-side-effect-of-text-mining-4b43f8ee1273‚ÄúThe end of our exploring will be to arrive at where we started, and to know the place for the first time.‚Äù‚Äî T. S. Eliot
I was reading lately lots of books on productivity and self-development and often I found pieces of advice that I want to re-read later. The highlighting option on kindle makes this very easy. By reading and highlighting consistently I accumulated a sizeable amount text which was a good representation of the books I read.">

  
  <link rel="alternate" hreflang="en-us" href="/r/text-mining-tutorial/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.54abc5f3f1ddc380a34d4103fd11d77a.css">

  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-148414815-1', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/r/text-mining-tutorial/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="SERDAR KORUR">
  <meta property="og:url" content="/r/text-mining-tutorial/">
  <meta property="og:title" content="An accidental side effect of text mining | SERDAR KORUR">
  <meta property="og:description" content="Extended version of https://towardsdatascience.com/an-accidental-side-effect-of-text-mining-4b43f8ee1273‚ÄúThe end of our exploring will be to arrive at where we started, and to know the place for the first time.‚Äù‚Äî T. S. Eliot
I was reading lately lots of books on productivity and self-development and often I found pieces of advice that I want to re-read later. The highlighting option on kindle makes this very easy. By reading and highlighting consistently I accumulated a sizeable amount text which was a good representation of the books I read."><meta property="og:image" content="/img/logo.png">
  <meta property="twitter:image" content="/img/logo.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-12-13T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2019-12-13T10:48:17&#43;01:00">
  

  


    






  





  





  





<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/r/text-mining-tutorial/"
  },
  "headline": "An accidental side effect of text mining",
  
  "datePublished": "2019-12-13T00:00:00Z",
  "dateModified": "2019-12-13T10:48:17+01:00",
  
  "author": {
    "@type": "Person",
    "name": "Serdar Korur"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "SERDAR KORUR",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/logo.png"
    }
  },
  "description": "Extended version of https://towardsdatascience.com/an-accidental-side-effect-of-text-mining-4b43f8ee1273\r‚ÄúThe end of our exploring will be to arrive at where we started, and to know the place for the first time.‚Äù\r‚Äî T. S. Eliot\nI was reading lately lots of books on productivity and self-development and often I found pieces of advice that I want to re-read later. The highlighting option on kindle makes this very easy. By reading and highlighting consistently I accumulated a sizeable amount text which was a good representation of the books I read."
}
</script>

  

  


  


  





  <title>An accidental side effect of text mining | SERDAR KORUR</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/"><img src="/img/logo.png" alt="SERDAR KORUR"></a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span></span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>An accidental side effect of text mining</h1>

  

  
    



<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Dec 13, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    54 min read
  </span>
  

  
  
  
  <span class="middot-divider"></span>
  <a href="/r/text-mining-tutorial/#disqus_thread"></a>
  

  
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/r/text-mining-tutorial/&amp;text=An%20accidental%20side%20effect%20of%20text%20mining" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/r/text-mining-tutorial/&amp;t=An%20accidental%20side%20effect%20of%20text%20mining" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=An%20accidental%20side%20effect%20of%20text%20mining&amp;body=/r/text-mining-tutorial/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/r/text-mining-tutorial/&amp;title=An%20accidental%20side%20effect%20of%20text%20mining" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=An%20accidental%20side%20effect%20of%20text%20mining%20/r/text-mining-tutorial/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/r/text-mining-tutorial/&amp;title=An%20accidental%20side%20effect%20of%20text%20mining" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      


<p><em>Extended version of <a href="https://towardsdatascience.com/an-accidental-side-effect-of-text-mining-4b43f8ee1273" class="uri">https://towardsdatascience.com/an-accidental-side-effect-of-text-mining-4b43f8ee1273</a></em>
<img src="/img/kindlebat.png" alt="configtoml" />
<strong><em>‚ÄúThe end of our exploring will be to arrive at where we started, and to know the place for the first time.‚Äù
‚Äî T. S. Eliot</em></strong></p>
<p>I was reading lately lots of books on productivity and self-development and often I found pieces of advice that I want to re-read later. The highlighting option on kindle makes this very easy. By reading and highlighting consistently <strong>I accumulated a sizeable amount text which was a good representation of the books I read.</strong></p>
<p>Since I know the content very well. I want to apply <strong>text mining</strong> and <strong>sentiment analysis</strong> to this data so that I can compare the results to my real opinion about the books. <strong>And if they match I will be more convinced to apply it to my next business problem.</strong></p>
<p>In part, this is also <strong>a self-exploration,</strong> since I could answer questions such as what kind of content I like more, what was their emotional charge?</p>
<p><strong>Let‚Äôs find the answers.</strong></p>
<p>To be objective, I will create an independent character called ‚Äúthe bat‚Äù. His next mission is to hack my data and analyze it to gather insights for selling me more books. Unfortunately, reading is not his specialty.</p>
<p>The room was in a mess when he entered. As he plugged the USB drive on his laptop, he barely heard the radio which was still on. The reporter:</p>
<blockquote>
<p>From the moment we switch on the early morning our cell phones to deal with the flood of information in some form of a whatsapp or facebook message or a tweet until we fall asleep at night overwriting or reading a product review we leave bread crumbs to our personal flavors on internet.</p>
</blockquote>
<blockquote>
<p>Many businesses use this unstructured data to drive their sales by better marketing through targeted product recommendations or to segregate their customers‚Ä¶</p>
</blockquote>
<p>He squeezed his teeth when he saw the data of 21000 lines of text from 28 books. His first encounter was the book ‚ÄúMindset‚Äù by Carol Dweck, where she introduces the concept of <strong>growth mindset.</strong> The idea behind is people who have the growth mindset believe their abilities can be improved by putting effort whereas the people with the fixed mindset believe that their abilities are fixed at birth. As a consequence, people who has the fixed mindset miss the opportunity to get better at many things even though they can. <strong>Simply, because they don‚Äôt believe in it in the first place.</strong></p>
<p>If you are not familiar with the concept, here is a <a href="https://youtu.be/hiiEeMN7vbQ">video</a> of Carol Dweck explaining her research on growth mindset.</p>
<p>Long lines of text made him tired, he didn‚Äôt realize how the time passed. Now, he was a man of growth. <strong>He decided to learn text mining.</strong></p>
<p>He started to learn the R packages for text mining, he didn‚Äôt like the package name tidytext but he was slightly losing his prejudices. It was a long night. He fell asleep on his table as the sun slowly rose.
‚Ä¶</p>
<p>It was lighting my back garden where I could glance from time to time to the trees painted by the snow overnight ‚õÑÔ∏è. Without an idea about how things went on the another part of the town, I continued to read and highlight my kindle as I zip from a glass of red wine üç∑.</p>
<p>‚Ä¶</p>
<p>We will know what happened to our hacker later. First, let‚Äôs go together through his notebook.</p>
<p><strong>The hacker‚Äôs notes</strong></p>
<p>He noted down each step of his text mining plan carefully. Let me help you go through them.</p>
<p>This is how the exported kindle highlights look like.<img src="/img/kindleclip.png" alt="configtoml" /></p>
<p>Reading and parsing the text file</p>
<pre class="r"><code># Use readLines function to parse the text file

highlights &lt;- readLines(&quot;posts_data/Kindle_highlights_Serdar.Rmd&quot;, encoding = &quot;UTF-8&quot;)

# Create a dataframe where each row is a line from the text

df &lt;- data.frame(highlights)

# Packages

library(tidyverse)   # includes ggplot2, dplyr, tidyr, readr, purrr, tibble, stringr, forcats
library(tidytext)
library(wordcloud2)</code></pre>
<p>Every data science project requires some sort of data preparation. <strong>Stop words</strong> are generally the most common words in a language and are usually filtered out before processing of text data.</p>
<p>Let‚Äôs look at the stop_words dataset from the tidytext package. Since it is a long list of words (&gt;1K) <strong>I will print every fifth word as an example.</strong></p>
<pre class="r"><code>data(stop_words)

# print every 50th word 

stop_words_small &lt;- stop_words[seq(1, nrow(stop_words), 50),]

stop_words_small %&gt;% print(n=50)</code></pre>
<pre><code>## # A tibble: 23 x 2
##    word       lexicon 
##    &lt;chr&gt;      &lt;chr&gt;   
##  1 a          SMART   
##  2 at         SMART   
##  3 contain    SMART   
##  4 few        SMART   
##  5 hers       SMART   
##  6 last       SMART   
##  7 nine       SMART   
##  8 presumably SMART   
##  9 some       SMART   
## 10 they&#39;d     SMART   
## 11 very       SMART   
## 12 without    SMART   
## 13 what       snowball
## 14 they&#39;ll    snowball
## 15 during     snowball
## 16 again      onix    
## 17 but        onix    
## 18 finds      onix    
## 19 if         onix    
## 20 much       onix    
## 21 parted     onix    
## 22 since      onix    
## 23 under      onix</code></pre>
<p>Every data science project requires some sort of data preparation. Stop words are generally the most common words in a language and are usually filtered out before processing of text data.</p>
<p>e.g.¬†they‚Äôll in stop_words</p>
<p>And how the word they‚Äôll appears in the text:</p>
<p>Yellow highlight | Page: 200
Memories are continually revised, along with the meaning we derive from them, so that in the future they‚Äôll be of even more use.</p>
<p>We have to make stop_words and our data compatible, otherwise some words such as they‚Äôll, don‚Äôt, can‚Äôt might appear in our results.</p>
<p>We can use <strong>str_replace_all()</strong> function from stringr package to find all the apostrophes and convert them into single quotes.</p>
<pre class="r"><code>df$highlights &lt;- str_replace_all(df$highlights, &quot;‚Äô&quot;, &quot;&#39;&quot;)</code></pre>
<p>Now, the text is ready for the frequency analysis. Words in a text mining project are called tokens. We can split the text into single words by unnest_tokens() function from tidytext package, filter the stop_words and count.</p>
<pre class="r"><code>df &lt;- df %&gt;% unnest_tokens(word, highlights) %&gt;%
             anti_join(stop_words) %&gt;% 
             filter(!word %in% c(&quot;highlights&quot;,&quot;highlight&quot;, &quot;page&quot;, 
                      &quot;location&quot;, &quot;yellow&quot;, &quot;pink&quot;, &quot;orange&quot;, &quot;blue&quot;))</code></pre>
<p>He also added here some additional words which frequently appear in kindle highlights output.</p>
<p><strong>dplyr()</strong> package functions are very useful for grouping and counting the words from the lists that are created.</p>
<pre class="r"><code>top_kindle_highlights &lt;- df %&gt;% 
 group_by(word) %&gt;% 
 count() %&gt;% 
 arrange(desc(n))</code></pre>
<p>He noted down his first insight. <strong>10 most frequent words from my kindle highlights.</strong></p>
<pre class="r"><code>top_kindle_highlights</code></pre>
<pre><code>## # A tibble: 12,433 x 2
## # Groups:   word [12,433]
##    word       n
##    &lt;chr&gt;  &lt;int&gt;
##  1 people   592
##  2 story    340
##  3 life     318
##  4 time     309
##  5 mind     213
##  6 change   212
##  7 feel     211
##  8 world    171
##  9 person   170
## 10 habits   157
## # ... with 12,423 more rows</code></pre>
<p>If you don‚Äôt like to look at long list of words wordclouds are a good alternative. Wordcloud2 package gives additional customization options for your wordclouds, for example you can use any image as a markup.<img src="/img/h7.png" alt="configtoml" /></p>
<pre class="r"><code>wordcloud2(top_kindle_highlights, figPath = bat, size = 1, backgroundColor = &quot;white&quot;, color = color_vector(data$freq) )</code></pre>
<p>Some ideas started to get shaped in his mind. He thought who made those highlights is someone interested in storytelling, writing and good communication, good habits, and people. <strong>Someone who wants to influence his life in a positive way. He was becoming more and more interested in the books.</strong></p>
<p>He wanted to dig deeper.</p>
<p><strong>Bigram Analysis</strong></p>
<p>Single words are a good starting point what the books were about. <strong>But they are limited without the context.</strong> Frequency analysis can also be performed to measure how often word pairs (bigrams) occur in the text. This allows us to capture finer details in the text.</p>
<p>To do this he combined the unnested single tokens which is isolated above back into a continuous text and then performed bigram analysis. You can use <strong>str_c()</strong> function from stringr package to concatenate the single words.</p>
<pre class="r"><code># Recreate the df
df &lt;- data.frame(highlights)
df$highlights &lt;- str_replace_all(df$highlights, &quot;‚Äô&quot;, &quot;&#39;&quot;)

df &lt;- df %&gt;% unnest_tokens(word, highlights) %&gt;% 
  anti_join(stop_words) %&gt;% 
 filter(!word %in% c(&quot;highlights&quot;,&quot;highlight&quot;, &quot;page&quot;, 
                      &quot;location&quot;, &quot;yellow&quot;, &quot;pink&quot;, &quot;orange&quot;, &quot;blue&quot;,
                      &quot;export&quot;, &quot;hidden&quot;, &quot;truncated&quot;, &quot;kindle&quot;, &quot;note&quot;, &quot;limits&quot;))

df_com &lt;- str_c(df$word, &quot; &quot;) 
df_com &lt;- data.frame(df_com)</code></pre>
<p>Let‚Äôs split the text into bigrams and count the most common word pairs.</p>
<pre class="r"><code>df_bigram &lt;- df_com %&gt;% 
 unnest_tokens(bigram, df_com, token = &quot;ngrams&quot;, 
 n = 3, n_min = 2)
top_bigrams &lt;- df_bigram %&gt;% 
 group_by(bigram) %&gt;% 
 count() %&gt;% 
 arrange(desc(n))%&gt;% 
 print(n=20)</code></pre>
<pre><code>## # A tibble: 107,317 x 2
## # Groups:   bigram [107,317]
##    bigram                    n
##    &lt;chr&gt;                 &lt;int&gt;
##  1 body language            30
##  2 behavior change          23
##  3 crucial conversations    19
##  4 fixed mindset            19
##  5 growth mindset           19
##  6 subconscious mind        19
##  7 told story               18
##  8 type person              17
##  9 object desire            16
## 10 system 1                 16
## 11 pay attention            15
## 12 bad habits               13
## 13 law behavior             13
## 14 law behavior change      13
## 15 social media             13
## 16 inciting incident        12
## 17 people feel              12
## 18 subject matter           12
## 19 human nature             11
## 20 objective criteria       11
## # ... with 1.073e+05 more rows</code></pre>
<pre class="r"><code># And visualize them on a plot

top &lt;- top_bigrams[1:25,]</code></pre>
<pre class="r"><code>top %&gt;% ungroup() %&gt;% mutate(bigram = fct_reorder(bigram, n)) %&gt;% 
 ggplot(aes(x=bigram, y=n)) + 
 geom_col() + 
 coord_flip() +
 theme_classic() + 
 theme(legend.position = &quot;none&quot;,
 text = element_text(size=18))</code></pre>
<p><img src="/post/2019-12-13-an-accidental-side-effect-of-text-mining_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>I see that one of the most frequent bigrams is behavioral change. We can use this information to make sense of what we have found previously. For example, one of the most frequent word was change. And we saw with bigram analysis that the word change was used mostly in a context of behavioral change. <strong>So bigrams are useful tools to get deeper insights about the text content.</strong></p>
<p>My highlighted text data come from 28 different books, and by looking at the most frequent words and bigrams in the whole document we got an overview of them.</p>
<p>To see how the individual books differ we can repeat this procedure for each of them.</p>
<p><strong>But how can we capture them individually?</strong></p>
<p>Let‚Äôs first look at the text once more.<img src="/img/kindleclip.png" />Before each book <strong>‚ÄúYour Kindle Notes For:‚Äù</strong> appears.</p>
<p>Let‚Äôs find out the line numbers for the beginning and the end of each book and use those indexes for fishing out each book.</p>
<p>We will reuse the data frame df we created above. str_which() function returns line index numbers which contain an given input pattern.</p>
<p>In the final step, a for loop to <strong>capture the text between two consecutive indexes will give us the book between them.</strong></p>
<pre class="r"><code># Since I modified df above. I will recreate it again.
df &lt;- data.frame(highlights)
df$highlights &lt;- str_replace_all(df$highlights, &quot;‚Äô&quot;, &quot;&#39;&quot;)

# Getting the index number for each book

indexes &lt;- str_which(df$highlights, pattern = fixed(&quot;Your Kindle Notes For&quot;))
book_names &lt;- df$highlights[indexes + 1]
indexes &lt;-  c(indexes,nrow(df))

# Create an empty list 

books &lt;- list()

# Now the trick. Capture each 28 book separately in a list. 

for(i in 1:(length(indexes)-1)) {
    books[[i]] &lt;- data.frame(df$highlights[(indexes[i]:indexes[i+1]-1)])
    colnames(books[[i]]) &lt;- &quot;word_column&quot;
    books[[i]]$word_column &lt;- as.character(books[[i]]$word_column)
}</code></pre>
<p>Let‚Äôs check whether it worked, for example you can look up the 5th book on our list.</p>
<pre class="r"><code>head(books[[5]])</code></pre>
<pre><code>##                                           word_column
## 1                                                    
## 2                              Your Kindle Notes For:
## 3 Bird by Bird: Some Instructions on Writing and Life
## 4                                         Anne Lamott
## 5             Last accessed on Saturday July 27, 2019
## 6                         75 Highlight(s) | 4 Note(s)</code></pre>
<pre class="r"><code>head(books[[15]])</code></pre>
<pre><code>##                                                  word_column
## 1                                                           
## 2                                     Your Kindle Notes For:
## 3 Getting to Yes: Negotiating an agreement without giving in
## 4                               Roger Fisher and William Ury
## 5                 Last accessed on Saturday November 3, 2018
## 6                               266 Highlight(s) | 3 Note(s)</code></pre>
<p>Now, we captured all 28 books and we can apply the same procedure to analyze each of them by another for loop.</p>
<pre class="r"><code>top &lt;- list()
for(i in 1:28){
books[[i]] &lt;- books[[i]] %&gt;% unnest_tokens(word, word_column) %&gt;%
             anti_join(stop_words) %&gt;% 
             filter(!word %in% c(&quot;highlights&quot;,&quot;highlight&quot;, &quot;page&quot;, 
                      &quot;location&quot;, &quot;yellow&quot;, &quot;pink&quot;, &quot;orange&quot;, &quot;blue&quot;,
                      &quot;export&quot;, &quot;hidden&quot;, &quot;truncated&quot;, &quot;kindle&quot;, &quot;note&quot;, &quot;limits&quot;))

# Find out the top words in each book and capture them in a list (top)

top[[i]] &lt;- books[[i]] %&gt;% 
              group_by(word) %&gt;% 
              count() %&gt;% 
              arrange(desc(n))
}
for(i in 1:28){
  print(book_names[[i]])
  print(top[[i]])
}</code></pre>
<pre><code>## [1] &quot;Thinking, Fast and Slow&quot;
## # A tibble: 1,619 x 2
## # Groups:   word [1,619]
##    word          n
##    &lt;chr&gt;     &lt;int&gt;
##  1 people       33
##  2 system       26
##  3 1            18
##  4 mind         18
##  5 effect       17
##  6 bad          15
##  7 cognitive    15
##  8 ease         15
##  9 theory       13
## 10 decision     12
## # ... with 1,609 more rows
## [1] &quot;Influence: The Psychology of Persuasion (Collins Business Essentials)&quot;
## # A tibble: 278 x 2
## # Groups:   word [278]
##    word            n
##    &lt;chr&gt;       &lt;int&gt;
##  1 142             5
##  2 146             5
##  3 131             3
##  4 147             3
##  5 154             3
##  6 179             3
##  7 association     3
##  8 food            3
##  9 information     3
## 10 people          3
## # ... with 268 more rows
## [1] &quot;On Writing Well, 30th Anniversary Edition: An Informal Guide to Writing Nonfiction&quot;
## # A tibble: 770 x 2
## # Groups:   word [770]
##    word         n
##    &lt;chr&gt;    &lt;int&gt;
##  1 writing     26
##  2 write       18
##  3 sentence    15
##  4 writer      15
##  5 reader      13
##  6 people      10
##  7 words        9
##  8 person       8
##  9 writers      8
## 10 day          7
## # ... with 760 more rows
## [1] &quot;Wired for Story: The Writer&#39;s Guide to Using Brain Science to Hook Readers from the Very First Sentence&quot;
## # A tibble: 1,657 x 2
## # Groups:   word [1,657]
##    word              n
##    &lt;chr&gt;         &lt;int&gt;
##  1 story           104
##  2 goal             41
##  3 protagonist      40
##  4 life             27
##  5 protagonist&#39;s    23
##  6 internal         21
##  7 brain            20
##  8 reader           20
##  9 external         19
## 10 world            19
## # ... with 1,647 more rows
## [1] &quot;Bird by Bird: Some Instructions on Writing and Life&quot;
## # A tibble: 522 x 2
## # Groups:   word [522]
##    word          n
##    &lt;chr&gt;     &lt;int&gt;
##  1 writing      17
##  2 mind          7
##  3 bird          6
##  4 voices        5
##  5 attention     4
##  6 day           4
##  7 hope          4
##  8 life          4
##  9 makes         4
## 10 muscles       4
## # ... with 512 more rows
## [1] &quot;Atomic Habits: An Easy and Proven Way to Build Good Habits and Break Bad Ones&quot;
## # A tibble: 2,736 x 2
## # Groups:   word [2,736]
##    word         n
##    &lt;chr&gt;    &lt;int&gt;
##  1 habits     140
##  2 habit      110
##  3 behavior    94
##  4 change      73
##  5 people      50
##  6 time        47
##  7 identity    38
##  8 day         36
##  9 brain       32
## 10 person      32
## # ... with 2,726 more rows
## [1] &quot;Storynomics: Story-Driven Marketing in the Post-Advertising World&quot;
## # A tibble: 3,042 x 2
## # Groups:   word [3,042]
##    word          n
##    &lt;chr&gt;     &lt;int&gt;
##  1 story       149
##  2 mind         50
##  3 stories      48
##  4 core         47
##  5 marketing    46
##  6 brand        45
##  7 life         42
##  8 change       41
##  9 audience     35
## 10 due          33
## # ... with 3,032 more rows
## [1] &quot;Crucial Conversations Tools for Talking When Stakes Are High, Second Edition&quot;
## # A tibble: 1,828 x 2
## # Groups:   word [1,828]
##    word              n
##    &lt;chr&gt;         &lt;int&gt;
##  1 people           84
##  2 dialogue         40
##  3 stories          40
##  4 due              34
##  5 feel             33
##  6 crucial          31
##  7 conversations    30
##  8 meaning          30
##  9 story            30
## 10 conversation     28
## # ... with 1,818 more rows
## [1] &quot;Pre-Suasion: A Revolutionary Way to Influence and Persuade&quot;
## # A tibble: 524 x 2
## # Groups:   word [524]
##    word             n
##    &lt;chr&gt;        &lt;int&gt;
##  1 attention        6
##  2 influence        5
##  3 mental           5
##  4 trust            5
##  5 visitors         5
##  6 comfort          4
##  7 emotional        4
##  8 experience       4
##  9 message          4
## 10 associations     3
## # ... with 514 more rows
## [1] &quot;Made to Stick: Why some ideas take hold and others come unstuck&quot;
## # A tibble: 1,752 x 2
## # Groups:   word [1,752]
##    word          n
##    &lt;chr&gt;     &lt;int&gt;
##  1 people       64
##  2 knowledge    27
##  3 story        25
##  4 ideas        24
##  5 concrete     18
##  6 surprise     17
##  7 care         16
##  8 time         15
##  9 attention    14
## 10 core         14
## # ... with 1,742 more rows
## [1] &quot;The Charisma Myth: Master the Art of Personal Magnetism&quot;
## # A tibble: 1,802 x 2
## # Groups:   word [1,802]
##    word            n
##    &lt;chr&gt;       &lt;int&gt;
##  1 feel           43
##  2 body           38
##  3 people         35
##  4 language       33
##  5 charisma       27
##  6 warmth         27
##  7 charismatic    24
##  8 power          22
##  9 person         19
## 10 confidence     18
## # ... with 1,792 more rows
## [1] &quot;The Power of Moments: Why Certain Experiences Have Extraordinary Impact&quot;
## # A tibble: 1,299 x 2
## # Groups:   word [1,299]
##    word              n
##    &lt;chr&gt;         &lt;int&gt;
##  1 moments          29
##  2 moment           21
##  3 people           17
##  4 time             15
##  5 insight          13
##  6 milestones       13
##  7 purpose          11
##  8 relationships    11
##  9 create            9
## 10 goal              9
## # ... with 1,289 more rows
## [1] &quot;Principles: Life and Work&quot;
## # A tibble: 1,131 x 2
## # Groups:   word [1,131]
##    word           n
##    &lt;chr&gt;      &lt;int&gt;
##  1 people        54
##  2 thinking      16
##  3 decision      12
##  4 level         12
##  5 life          12
##  6 pain          12
##  7 habits        11
##  8 understand    11
##  9 change        10
## 10 knowing       10
## # ... with 1,121 more rows
## [1] &quot;Deep Work: Rules for Focused Success in a Distracted World&quot;
## # A tibble: 711 x 2
## # Groups:   word [711]
##    word          n
##    &lt;chr&gt;     &lt;int&gt;
##  1 attention    12
##  2 deep         11
##  3 ability       9
##  4 book          9
##  5 life          9
##  6 time          9
##  7 mind          7
##  8 world         7
##  9 focus         6
## 10 called        5
## # ... with 701 more rows
## [1] &quot;Getting to Yes: Negotiating an agreement without giving in&quot;
## # A tibble: 1,489 x 2
## # Groups:   word [1,489]
##    word            n
##    &lt;chr&gt;       &lt;int&gt;
##  1 agreement      33
##  2 negotiation    33
##  3 options        23
##  4 people         19
##  5 objective      17
##  6 positions      17
##  7 ideas          16
##  8 position       15
##  9 shared         15
## 10 solution       15
## # ... with 1,479 more rows
## [1] &quot;Who: The A Method for Hiring&quot;
## # A tibble: 920 x 2
## # Groups:   word [920]
##    word           n
##    &lt;chr&gt;      &lt;int&gt;
##  1 people        38
##  2 job           22
##  3 players       16
##  4 person        15
##  5 candidate     14
##  6 candidates    13
##  7 company       13
##  8 hire          11
##  9 hiring        11
## 10 interview     11
## # ... with 910 more rows
## [1] &quot;Mindset: Changing The Way You think To Fulfil Your Potential&quot;
## # A tibble: 910 x 2
## # Groups:   word [910]
##    word         n
##    &lt;chr&gt;    &lt;int&gt;
##  1 mindset     43
##  2 people      33
##  3 growth      27
##  4 fixed       23
##  5 blame       18
##  6 learning    16
##  7 learn       15
##  8 effort      11
##  9 failure     11
## 10 makes       10
## # ... with 900 more rows
## [1] &quot;The 4-Hour Work Week: Escape the 9-5, Live Anywhere and Join the New Rich&quot;
## # A tibble: 736 x 2
## # Groups:   word [736]
##    word          n
##    &lt;chr&gt;     &lt;int&gt;
##  1 time         11
##  2 life         10
##  3 mail          6
##  4 product       6
##  5 week          6
##  6 world         6
##  7 baby          5
##  8 celebrity     5
##  9 create        5
## 10 days          5
## # ... with 726 more rows
## [1] &quot;Tools of Titans: The Tactics, Routines, and Habits of Billionaires, Icons, and World-Class Performers&quot;
## # A tibble: 1,956 x 2
## # Groups:   word [1,956]
##    word       n
##    &lt;chr&gt;  &lt;int&gt;
##  1 people    41
##  2 life      25
##  3 time      24
##  4 write     24
##  5 world     22
##  6 10        17
##  7 ideas     14
##  8 book      13
##  9 times     12
## 10 read      11
## # ... with 1,946 more rows
## [1] &quot;The Elements of Eloquence: How to Turn the Perfect English Phrase&quot;
## # A tibble: 116 x 2
## # Groups:   word [116]
##    word           n
##    &lt;chr&gt;      &lt;int&gt;
##  1 change         5
##  2 english        3
##  3 pattern        3
##  4 poets          3
##  5 19             2
##  6 44             2
##  7 attitude       2
##  8 colour         2
##  9 contradict     2
## 10 fall           2
## # ... with 106 more rows
## [1] &quot;The One Thing: The Surprisingly Simple Truth Behind Extraordinary Results: Achieve your goals with one of the world&#39;s bestselling success books (Basic Skills)&quot;
## # A tibble: 587 x 2
## # Groups:   word [587]
##    word              n
##    &lt;chr&gt;         &lt;int&gt;
##  1 time             29
##  2 success          15
##  3 results          11
##  4 block             9
##  5 day               9
##  6 extraordinary     9
##  7 life              8
##  8 matters           8
##  9 successful        8
## 10 discipline        7
## # ... with 577 more rows
## [1] &quot;How to Win Friends and Influence People&quot;
## # A tibble: 140 x 2
## # Groups:   word [140]
##    word          n
##    &lt;chr&gt;     &lt;int&gt;
##  1 people        7
##  2 ability       3
##  3 fears         3
##  4 116           2
##  5 book          2
##  6 human         2
##  7 knowledge     2
##  8 meeting       2
##  9 person&#39;s      2
## 10 sell          2
## # ... with 130 more rows
## [1] &quot;The Untethered Soul: The Journey Beyond Yourself&quot;
## # A tibble: 770 x 2
## # Groups:   word [770]
##    word           n
##    &lt;chr&gt;      &lt;int&gt;
##  1 life          73
##  2 feel          34
##  3 events        26
##  4 mind          25
##  5 world         20
##  6 fear          19
##  7 inside        19
##  8 energy        17
##  9 experience    17
## 10 heart         17
## # ... with 760 more rows
## [1] &quot;Man&#39;s Search For Meaning: The classic tribute to hope from the Holocaust&quot;
## # A tibble: 894 x 2
## # Groups:   word [894]
##    word            n
##    &lt;chr&gt;       &lt;int&gt;
##  1 life           29
##  2 suffering      24
##  3 meaning        20
##  4 human          19
##  5 intention      11
##  6 75              9
##  7 logotherapy     9
##  8 patient         9
##  9 world           9
## 10 called          8
## # ... with 884 more rows
## [1] &quot;The Power of your Subconscious Mind and Other Works&quot;
## # A tibble: 600 x 2
## # Groups:   word [600]
##    word             n
##    &lt;chr&gt;        &lt;int&gt;
##  1 mind            34
##  2 subconscious    28
##  3 wealth          13
##  4 idea            11
##  5 mental          10
##  6 love             9
##  7 life             8
##  8 peace            8
##  9 happiness        7
## 10 desire           6
## # ... with 590 more rows
## [1] &quot;Ego is the Enemy: The Fight to Master Our Greatest Opponent&quot;
## # A tibble: 831 x 2
## # Groups:   word [831]
##    word         n
##    &lt;chr&gt;    &lt;int&gt;
##  1 ego         19
##  2 people      12
##  3 purpose     11
##  4 111          8
##  5 change       7
##  6 147          6
##  7 function     6
##  8 life         6
##  9 passion      6
## 10 path         6
## # ... with 821 more rows
## [1] &quot;Outliers: The Story of Success&quot;
## # A tibble: 105 x 2
## # Groups:   word [105]
##    word             n
##    &lt;chr&gt;        &lt;int&gt;
##  1 ability          3
##  2 knowing          3
##  3 sense            3
##  4 communicate      2
##  5 distance         2
##  6 family           2
##  7 intelligence     2
##  8 power            2
##  9 practical        2
## 10 sternberg        2
## # ... with 95 more rows
## [1] &quot;The Start-up of You: Adapt to the Future, Invest in Yourself, and Transform Your Career&quot;
## # A tibble: 570 x 2
## # Groups:   word [570]
##    word              n
##    &lt;chr&gt;         &lt;int&gt;
##  1 people           14
##  2 product           8
##  3 opportunities     7
##  4 person            7
##  5 start             7
##  6 assets            6
##  7 job               6
##  8 time              6
##  9 138               5
## 10 create            5
## # ... with 560 more rows</code></pre>
<p>Now, looking at the frequent words from each book we can get more insights what they are about.</p>
<p>The bigrams for the same books.</p>
<pre class="r"><code>df &lt;- data.frame(highlights)
df$highlights &lt;- str_replace_all(df$highlights, &quot;‚Äô&quot;, &quot;&#39;&quot;)

# Getting the index number for each book

indexes &lt;- str_which(df$highlights, pattern = fixed(&quot;Your Kindle Notes For&quot;))
book_names &lt;- df$highlights[indexes + 1]
indexes &lt;-  c(indexes,nrow(df))

# Capturing each book individually

books &lt;- list()
for (i in 1:(length(indexes)-1)) {
    books[[i]] &lt;- data.frame(df$highlights[(indexes[i]:indexes[i+1]-1)])
    colnames(books[[i]]) &lt;- &quot;word_column&quot;
    books[[i]]$word_column &lt;- as.character(books[[i]]$word_column)
}

# Next step in the plan was splitting the text into single words by unnest_tokens function.



for(i in 1:28){
books[[i]] &lt;- books[[i]] %&gt;% unnest_tokens(word, word_column) %&gt;%
             anti_join(stop_words) %&gt;% 
             filter(!word %in% c(&quot;highlights&quot;,&quot;highlight&quot;, &quot;page&quot;, 
                      &quot;location&quot;, &quot;yellow&quot;, &quot;pink&quot;, &quot;orange&quot;, &quot;blue&quot;,
                      &quot;export&quot;, &quot;hidden&quot;, &quot;truncated&quot;, &quot;kindle&quot;, &quot;note&quot;, &quot;limits&quot;))
}

# After this preparation step I can combine the single words back into a continous text

for(i in 1:28){
books[[i]] &lt;- str_c(books[[i]]$word, &quot; &quot;) 
books[[i]] &lt;- data.frame(books[[i]]) 
}


df_bigram &lt;- list()

for(i in 1:28){                      
df_bigram[[i]] &lt;- books[[i]] %&gt;% 
       unnest_tokens(bigram, books..i.., token = &quot;ngrams&quot;, 
                                     n = 3, n_min = 2)
}

for (i in 1:28){
  print(book_names[i])
df_bigram[[i]] %&gt;% 
  group_by(bigram) %&gt;% 
  count() %&gt;% 
  arrange(desc(n))%&gt;% 
  print(n=10)
  
}</code></pre>
<pre><code>## [1] &quot;Thinking, Fast and Slow&quot;
## # A tibble: 5,768 x 2
## # Groups:   bigram [5,768]
##    bigram                    n
##    &lt;chr&gt;                 &lt;int&gt;
##  1 system 1                 16
##  2 cognitive ease            9
##  3 system 2                  8
##  4 halo effect               4
##  5 loss aversion             4
##  6 possibility effect        4
##  7 affective forecasting     3
##  8 availability bias         3
##  9 cognitive strain          3
## 10 decision weights          3
## # ... with 5,758 more rows
## [1] &quot;Influence: The Psychology of Persuasion (Collins Business Essentials)&quot;
## # A tibble: 673 x 2
## # Groups:   bigram [673]
##    bigram                    n
##    &lt;chr&gt;                 &lt;int&gt;
##  1 association principle     2
##  2 click whirr               2
##  3 click whirr response      2
##  4 luncheon technique        2
##  5 reciprocity rule          2
##  6 whirr response            2
##  7 0 13                      1
##  8 0 13 rule                 1
##  9 13 rule                   1
## 10 13 rule reciprocation     1
## # ... with 663 more rows
## [1] &quot;On Writing Well, 30th Anniversary Edition: An Informal Guide to Writing Nonfiction&quot;
## # A tibble: 2,172 x 2
## # Groups:   bigram [2,172]
##    bigram                       n
##    &lt;chr&gt;                    &lt;int&gt;
##  1 500th appendix               2
##  2 choice unity                 2
##  3 confronted solved            2
##  4 despair finding              2
##  5 despair finding solution     2
##  6 english language             2
##  7 federal buildings            2
##  8 finally solve                2
##  9 finally solve surgeon        2
## 10 finding solution             2
## # ... with 2,162 more rows
## [1] &quot;Wired for Story: The Writer&#39;s Guide to Using Brain Science to Hook Readers from the Very First Sentence&quot;
## # A tibble: 6,602 x 2
## # Groups:   bigram [6,602]
##    bigram                    n
##    &lt;chr&gt;                 &lt;int&gt;
##  1 external goal             8
##  2 internal goal             6
##  3 cognitive unconscious     5
##  4 internal issue            5
##  5 real life                 5
##  6 story question            5
##  7 antonio damasio           4
##  8 effect trajectory         4
##  9 steven pinker             4
## 10 1 story                   3
## # ... with 6,592 more rows
## [1] &quot;Bird by Bird: Some Instructions on Writing and Life&quot;
## # A tibble: 1,304 x 2
## # Groups:   bigram [1,304]
##    bigram                   n
##    &lt;chr&gt;                &lt;int&gt;
##  1 bird bird                3
##  2 muscles cramp            3
##  3 cramp wounds             2
##  4 life view                2
##  5 likable narrator         2
##  6 muscles cramp wounds     2
##  7 pay attention            2
##  8 1,015 read               1
##  9 1,015 read reading       1
## 10 1,048 digress            1
## # ... with 1,294 more rows
## [1] &quot;Atomic Habits: An Easy and Proven Way to Build Good Habits and Break Bad Ones&quot;
## # A tibble: 12,309 x 2
## # Groups:   bigram [12,309]
##    bigram                  n
##    &lt;chr&gt;               &lt;int&gt;
##  1 behavior change        23
##  2 type person            17
##  3 law behavior           13
##  4 law behavior change    13
##  5 bad habits             11
##  6 social media            9
##  7 habits attractive       6
##  8 3rd law                 5
##  9 bad habit               5
## 10 break chain             5
## # ... with 1.23e+04 more rows
## [1] &quot;Storynomics: Story-Driven Marketing in the Post-Advertising World&quot;
## # A tibble: 12,819 x 2
## # Groups:   bigram [12,819]
##    bigram                 n
##    &lt;chr&gt;              &lt;int&gt;
##  1 object desire         16
##  2 told story            16
##  3 inciting incident     12
##  4 positive negative     10
##  5 purpose told          10
##  6 subject matter        10
##  7 core character         9
##  8 purpose told story     8
##  9 real beauty            7
## 10 change team&#39;s          6
## # ... with 1.281e+04 more rows
## [1] &quot;Crucial Conversations Tools for Talking When Stakes Are High, Second Edition&quot;
## # A tibble: 8,751 x 2
## # Groups:   bigram [8,751]
##    bigram                    n
##    &lt;chr&gt;                 &lt;int&gt;
##  1 crucial conversations    19
##  2 due 27                   10
##  3 mutual purpose           10
##  4 shared pool               8
##  5 silence violence          8
##  6 crucial conversation      7
##  7 path action               7
##  8 due 26                    6
##  9 due 43                    6
## 10 fool&#39;s choice             6
## # ... with 8,741 more rows
## [1] &quot;Pre-Suasion: A Revolutionary Way to Influence and Persuade&quot;
## # A tibble: 1,261 x 2
## # Groups:   bigram [1,261]
##    bigram                      n
##    &lt;chr&gt;                   &lt;int&gt;
##  1 attention goal              2
##  2 concept audience            2
##  3 levels importance           2
##  4 mandel johnson              2
##  5 mental activity             2
##  6 social proof                2
##  7 thousand dollars            2
##  8 twenty thousand             2
##  9 twenty thousand dollars     2
## 10 writing session             2
## # ... with 1,251 more rows
## [1] &quot;Made to Stick: Why some ideas take hold and others come unstuck&quot;
## # A tibble: 6,372 x 2
## # Groups:   bigram [6,372]
##    bigram                      n
##    &lt;chr&gt;                   &lt;int&gt;
##  1 curse knowledge             7
##  2 guessing machines           6
##  3 people care                 6
##  4 goodyear tires              5
##  5 knowledge gaps              5
##  6 people&#39;s attention          5
##  7 popcorn popper              5
##  8 security goodyear           5
##  9 security goodyear tires     5
## 10 sinatra test                5
## # ... with 6,362 more rows
## [1] &quot;The Charisma Myth: Master the Art of Personal Magnetism&quot;
## # A tibble: 6,343 x 2
## # Groups:   bigram [6,343]
##    bigram                        n
##    &lt;chr&gt;                     &lt;int&gt;
##  1 body language                30
##  2 power warmth                  6
##  3 feel bad                      4
##  4 imagination reality           4
##  5 people feel                   4
##  6 responsibility transfer       4
##  7 charismatic body              3
##  8 charismatic body language     3
##  9 confidence ability            3
## 10 distinguish imagination       3
## # ... with 6,333 more rows
## [1] &quot;The Power of Moments: Why Certain Experiences Have Extraordinary Impact&quot;
## # A tibble: 3,967 x 2
## # Groups:   bigram [3,967]
##    bigram                         n
##    &lt;chr&gt;                      &lt;int&gt;
##  1 defining moments               5
##  2 backward integrated            3
##  3 backward integrated design     3
##  4 breaking script                3
##  5 connecting meaning             3
##  6 integrated design              3
##  7 moments pride                  3
##  8 understanding validation       3
##  9 bad stronger                   2
## 10 bose headphones                2
## # ... with 3,957 more rows
## [1] &quot;Principles: Life and Work&quot;
## # A tibble: 3,960 x 2
## # Groups:   bigram [3,960]
##    bigram                   n
##    &lt;chr&gt;                &lt;int&gt;
##  1 common sense             3
##  2 left brained             3
##  3 responsible parties      3
##  4 134 people               2
##  5 274 remember             2
##  6 407 values               2
##  7 407 values abilities     2
##  8 achieve goals            2
##  9 bad outcomes             2
## 10 blind spots              2
## # ... with 3,950 more rows
## [1] &quot;Deep Work: Rules for Focused Success in a Distracted World&quot;
## # A tibble: 1,981 x 2
## # Groups:   bigram [1,981]
##    bigram                  n
##    &lt;chr&gt;               &lt;int&gt;
##  1 deliberate practice     4
##  2 13 master               2
##  3 14 deep                 2
##  4 29 ability              2
##  5 77 gallagher            2
##  6 ability concentrate     2
##  7 anders ericsson         2
##  8 book shining            2
##  9 choose focus            2
## 10 fixed schedule          2
## # ... with 1,971 more rows
## [1] &quot;Getting to Yes: Negotiating an agreement without giving in&quot;
## # A tibble: 5,363 x 2
## # Groups:   bigram [5,363]
##    bigram                     n
##    &lt;chr&gt;                  &lt;int&gt;
##  1 objective criteria        11
##  2 principled negotiation     8
##  3 bottom line                6
##  4 inventing options          6
##  5 mutual gain                6
##  6 reach agreement            6
##  7 reaching agreement         6
##  8 options mutual             5
##  9 options mutual gain        5
## 10 brainstorming session      4
## # ... with 5,353 more rows
## [1] &quot;Who: The A Method for Hiring&quot;
## # A tibble: 3,196 x 2
## # Groups:   bigram [3,196]
##    bigram                     n
##    &lt;chr&gt;                  &lt;int&gt;
##  1 talented people            6
##  2 outcomes competencies      4
##  3 96 performance             3
##  4 96 performance compare     3
##  5 fit company                3
##  6 performance compare        3
##  7 2 million                  2
##  8 95 interrupt               2
##  9 career goals               2
## 10 company 31                 2
## # ... with 3,186 more rows
## [1] &quot;Mindset: Changing The Way You think To Fulfil Your Potential&quot;
## # A tibble: 3,182 x 2
## # Groups:   bigram [3,182]
##    bigram                   n
##    &lt;chr&gt;                &lt;int&gt;
##  1 fixed mindset           19
##  2 growth mindset          19
##  3 people fixed             4
##  4 people fixed mindset     4
##  5 183 son                  3
##  6 assign blame             3
##  7 social interactions      3
##  8 142 create               2
##  9 157 fixed                2
## 10 157 fixed mindset        2
## # ... with 3,172 more rows
## [1] &quot;The 4-Hour Work Week: Escape the 9-5, Live Anywhere and Join the New Rich&quot;
## # A tibble: 1,927 x 2
## # Groups:   bigram [1,927]
##    bigram                     n
##    &lt;chr&gt;                  &lt;int&gt;
##  1 http e.ggtimer.com         3
##  2 basic assumptions          2
##  3 car seat                   2
##  4 limit tasks                2
##  5 offer customer             2
##  6 options offer              2
##  7 options offer customer     2
##  8 parkinson&#39;s law            2
##  9 shorten time               2
## 10 suggest days               2
## # ... with 1,917 more rows
## [1] &quot;Tools of Titans: The Tactics, Routines, and Habits of Billionaires, Icons, and World-Class Performers&quot;
## # A tibble: 6,321 x 2
## # Groups:   bigram [6,321]
##    bigram                  n
##    &lt;chr&gt;               &lt;int&gt;
##  1 10 ideas                4
##  2 bad ideas               4
##  3 keeping track           4
##  4 track times             4
##  5 world war               4
##  6 516 write               3
##  7 extreme ownership       3
##  8 heart head              3
##  9 keeping track times     3
## 10 narrative narrative     3
## # ... with 6,311 more rows
## [1] &quot;The Elements of Eloquence: How to Turn the Perfect English Phrase&quot;
## # A tibble: 272 x 2
## # Groups:   bigram [272]
##    bigram                    n
##    &lt;chr&gt;                 &lt;int&gt;
##  1 change attitude           2
##  2 change pattern            2
##  3 change pattern change     2
##  4 fall love                 2
##  5 pattern change            2
##  6 0 19                      1
##  7 0 19 bred                 1
##  8 11 2018                   1
##  9 11 2018 8                 1
## 10 19 bred                   1
## # ... with 262 more rows
## [1] &quot;The One Thing: The Surprisingly Simple Truth Behind Extraordinary Results: Achieve your goals with one of the world&#39;s bestselling success books (Basic Skills)&quot;
## # A tibble: 1,629 x 2
## # Groups:   bigram [1,629]
##    bigram                    n
##    &lt;chr&gt;                 &lt;int&gt;
##  1 extraordinary results     7
##  2 time block                7
##  3 selected discipline       3
##  4 3 time                    2
##  5 3 time block              2
##  6 achieve extraordinary     2
##  7 block day                 2
##  8 default settings          2
##  9 discipline build          2
## 10 easier unnecessary        2
## # ... with 1,619 more rows
## [1] &quot;How to Win Friends and Influence People&quot;
## # A tibble: 318 x 2
## # Groups:   bigram [318]
##    bigram               n
##    &lt;chr&gt;            &lt;int&gt;
##  1 time meeting         2
##  2 0 72                 1
##  3 0 72 lies            1
##  4 110 people           1
##  5 110 people smile     1
##  6 112 time             1
##  7 112 time meeting     1
##  8 116 116              1
##  9 116 116 bad          1
## 10 116 bad              1
## # ... with 308 more rows
## [1] &quot;The Untethered Soul: The Journey Beyond Yourself&quot;
## # A tibble: 3,195 x 2
## # Groups:   bigram [3,195]
##    bigram                   n
##    &lt;chr&gt;                &lt;int&gt;
##  1 preconceived notions     8
##  2 life avoiding            7
##  3 devote life              6
##  4 empty space              5
##  5 experience life          5
##  6 model reality            5
##  7 rest life                5
##  8 spend life               5
##  9 spend life avoiding      5
## 10 153 events               4
## # ... with 3,185 more rows
## [1] &quot;Man&#39;s Search For Meaning: The classic tribute to hope from the Holocaust&quot;
## # A tibble: 2,917 x 2
## # Groups:   bigram [2,917]
##    bigram                    n
##    &lt;chr&gt;                 &lt;int&gt;
##  1 paradoxical intention     6
##  2 hyper intention           4
##  3 anticipatory anxiety      3
##  4 existential vacuum        3
##  5 fall asleep               3
##  6 human existence           3
##  7 intention fall            3
##  8 intention fall asleep     3
##  9 meaning life              3
## 10 potential meaning         3
## # ... with 2,907 more rows
## [1] &quot;The Power of your Subconscious Mind and Other Works&quot;
## # A tibble: 1,750 x 2
## # Groups:   bigram [1,750]
##    bigram                         n
##    &lt;chr&gt;                      &lt;int&gt;
##  1 subconscious mind             17
##  2 dominant idea                  4
##  3 idea subconscious              3
##  4 peace mind                     3
##  5 power subconscious             3
##  6 accept idea                    2
##  7 accepted subconscious          2
##  8 accepted subconscious mind     2
##  9 annoy irritate                 2
## 10 annoy irritate permit          2
## # ... with 1,740 more rows
## [1] &quot;Ego is the Enemy: The Fight to Master Our Greatest Opponent&quot;
## # A tibble: 2,290 x 2
## # Groups:   bigram [2,290]
##    bigram                 n
##    &lt;chr&gt;              &lt;int&gt;
##  1 112 start              2
##  2 147 deceived           2
##  3 33 purpose             2
##  4 beat people            2
##  5 ego enemy              2
##  6 function function      2
##  7 people beat            2
##  8 people beat people     2
##  9 people beneath         2
## 10 purpose realism        2
## # ... with 2,280 more rows
## [1] &quot;Outliers: The Story of Success&quot;
## # A tibble: 232 x 2
## # Groups:   bigram [232]
##    bigram                           n
##    &lt;chr&gt;                        &lt;int&gt;
##  1 knowing knowing                  2
##  2 power distance                   2
##  3 practical intelligence           2
##  4 0 884                            1
##  5 0 884 write                      1
##  6 1,051 robert                     1
##  7 1,051 robert sternberg           1
##  8 1,052 practical                  1
##  9 1,052 practical intelligence     1
## 10 1,063 annette                    1
## # ... with 222 more rows
## [1] &quot;The Start-up of You: Adapt to the Future, Invest in Yourself, and Transform Your Career&quot;
## # A tibble: 1,611 x 2
## # Groups:   bigram [1,611]
##    bigram                 n
##    &lt;chr&gt;              &lt;int&gt;
##  1 product management     3
##  2 faster cheaper         2
##  3 skills experiences     2
##  4 soft assets            2
##  5 weak ties              2
##  6 0 15                   1
##  7 0 15 paranoid          1
##  8 101 business           1
##  9 101 business crazy     1
## 10 101 inspired           1
## # ... with 1,601 more rows</code></pre>
<p>If you want to see another example of this capturing process you can have a look at my recent post <a href="https://dataatomic.com/r/data-wrangling-text-mining/">here</a>.</p>
<p>Looking at each book individually, he started to be more and more obsessed about the books in my kindle. He decided to order a couple of them.</p>
<p>We can use <strong>sentiment analysis</strong> to evaluate emotional charge in a text data. Most common uses are social media monitoring, customer experience management, and Voice of Customer, to understand how they feel.</p>
<p>The <strong>bing</strong> lexicon categorizes words into positive and negative categories, in a binary fashion. The <strong>nrc</strong> lexicon uses categories of positive, negative, anger, anticipation, disgust, fear, joy, sadness, surprise, and trust.</p>
<p><strong>Using bing lexicon</strong></p>
<p>I created a list of the words with highest contribution to each emotional category. For example success and effective for positive, bad and hard for negative sentiment.<img src="/img/sentiment1.png" /></p>
<p>Here is how R produced the above plot:</p>
<pre class="r"><code>df &lt;- data.frame(highlights)
df$highlights &lt;- str_replace_all(df$highlights, &quot;‚Äô&quot;, &quot;&#39;&quot;)
df &lt;- df %&gt;% unnest_tokens(word, highlights) %&gt;% 
  anti_join(stop_words) %&gt;% 
 filter(!word %in% c(&quot;highlights&quot;,&quot;highlight&quot;, &quot;page&quot;, 
                      &quot;location&quot;, &quot;yellow&quot;, &quot;pink&quot;, &quot;orange&quot;, &quot;blue&quot;,
                      &quot;export&quot;, &quot;hidden&quot;, &quot;truncated&quot;, &quot;kindle&quot;, &quot;note&quot;, &quot;limits&quot;))

bing_word_counts &lt;- df %&gt;% inner_join(get_sentiments(&quot;bing&quot;)) %&gt;% 
  count(word, sentiment, sort = TRUE) %&gt;%
  ungroup()

bing_word_counts</code></pre>
<pre><code>## # A tibble: 1,854 x 3
##    word      sentiment     n
##    &lt;chr&gt;     &lt;chr&gt;     &lt;int&gt;
##  1 bad       negative     93
##  2 success   positive     91
##  3 hard      negative     85
##  4 love      positive     69
##  5 difficult negative     63
##  6 negative  negative     63
##  7 easy      positive     62
##  8 fear      negative     62
##  9 wrong     negative     62
## 10 positive  positive     58
## # ... with 1,844 more rows</code></pre>
<pre class="r"><code># Top contributors to positive and negative sentiment

bing &lt;- bing_word_counts %&gt;% 
  group_by(sentiment) %&gt;% 
  top_n(10) %&gt;% 
  ggplot(aes(reorder(word, n), n, fill=sentiment)) + 
  geom_bar(alpha=0.8, stat=&quot;identity&quot;, show.legend = FALSE)+
  facet_wrap(~sentiment, scales = &quot;free_y&quot;) +
  labs(y= &quot;Contribution to sentiment&quot;, x = NULL) +
  coord_flip()
bing</code></pre>
<p><strong>Using nrc lexion</strong></p>
<p>I am more likely to highlight a text if it is positive rather than negative. And also trust, anticipation and joy rather than sadness or anger.</p>
<pre class="r"><code>df &lt;- data.frame(highlights)
df$highlights &lt;- str_replace_all(df$highlights, &quot;‚Äô&quot;, &quot;&#39;&quot;)
df &lt;- df %&gt;% unnest_tokens(word, highlights) %&gt;% 
  anti_join(stop_words) %&gt;% 
 filter(!word %in% c(&quot;highlights&quot;,&quot;highlight&quot;, &quot;page&quot;, 
                      &quot;location&quot;, &quot;yellow&quot;, &quot;pink&quot;, &quot;orange&quot;, &quot;blue&quot;,
                      &quot;export&quot;, &quot;hidden&quot;, &quot;truncated&quot;, &quot;kindle&quot;, &quot;note&quot;, &quot;limits&quot;))</code></pre>
<pre><code>## Joining, by = &quot;word&quot;</code></pre>
<pre class="r"><code>sentiment &lt;- df %&gt;%
        left_join(get_sentiments(&quot;nrc&quot;)) %&gt;%
        filter(!is.na(sentiment)) %&gt;%
        count(sentiment, sort = TRUE)</code></pre>
<pre><code>## Joining, by = &quot;word&quot;</code></pre>
<pre class="r"><code>sentiment</code></pre>
<pre><code>## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive      8326
##  2 trust         4165
##  3 negative      3860
##  4 anticipation  3366
##  5 joy           2642
##  6 fear          2446
##  7 sadness       1844
##  8 anger         1799
##  9 surprise      1339
## 10 disgust       1093</code></pre>
<p><strong>Normalized sentiments</strong></p>
<p>One important thing to add, since each emotion category has different number of words in a language. Emotional categories with less words are less likely to appear in a given text. Thus, I would like to normalize them according to their numbers in the lexicon and see how it differs than the above results.</p>
<pre class="r"><code># I will add numbers of each categories from the NRC lexicon

lexicon &lt;- c(2317, 3338, 1234, 842, 1483, 691, 1250, 1195, 1060, 535)
polarity &lt;-  c(1,1,1,1,1,0,0,0,0,0)
sentiment &lt;- data.frame(sentiment, lexicon)
norm_sentiment &lt;- sentiment %&gt;% mutate( normalized = n/lexicon) %&gt;% arrange(desc(normalized))
sentiment &lt;- data.frame(norm_sentiment, polarity)
sentiment</code></pre>
<pre><code>##       sentiment    n lexicon normalized polarity
## 1  anticipation 3366     842   3.997625        1
## 2      positive 8326    2317   3.593440        1
## 3          fear 2446     691   3.539797        1
## 4      negative 3860    1234   3.128039        1
## 5       disgust 1093     535   2.042991        1
## 6           joy 2642    1483   1.781524        0
## 7         anger 1799    1195   1.505439        0
## 8       sadness 1844    1250   1.475200        0
## 9      surprise 1339    1060   1.263208        0
## 10        trust 4165    3338   1.247753        0</code></pre>
<pre class="r"><code># General findings

sentiment %&gt;% group_by(polarity) %&gt;% summarize(n2 = sum(lexicon))</code></pre>
<pre><code>## # A tibble: 2 x 2
##   polarity    n2
##      &lt;dbl&gt; &lt;dbl&gt;
## 1        0  8326
## 2        1  5619</code></pre>
<p>Now, <strong>anticipation</strong> is the highest emotion found in the text that I highlighted. This does not seem a coincidence to me. Since most of the books in our analysis is about productivity and self-development. The productivity tips and tools usually contain words associated with anticipation.</p>
<p>In a similar way, I can look at the sentiment for individual books</p>
<pre class="r"><code>df &lt;- data.frame(highlights)

# Kindle uses apostrophes (‚Äô), but stop_words uses sigle quotes (&#39;) 
# To be able to use all stop_words I should replace apostrophes with quotes
df$highlights &lt;- str_replace_all(df$highlights, &quot;‚Äô&quot;, &quot;&#39;&quot;)

# Getting the index number for each book

indexes &lt;- str_which(df$highlights, pattern = fixed(&quot;Your Kindle Notes For&quot;))
book_names &lt;- df$highlights[indexes + 1]
indexes &lt;-  c(indexes,nrow(df))

# Capturing each book individually

books &lt;- list()
for (i in 1:(length(indexes)-1)) {
    books[[i]] &lt;- data.frame(df$highlights[(indexes[i]:indexes[i+1]-1)])
    colnames(books[[i]]) &lt;- &quot;word_column&quot;
    books[[i]]$word_column &lt;- as.character(books[[i]]$word_column)
}

# Next step in the plan was splitting the text into single words by unnest_tokens function.


for(i in 1:28){
books[[i]] &lt;- books[[i]] %&gt;% unnest_tokens(word, word_column) %&gt;%
             anti_join(stop_words) %&gt;% 
             filter(!word %in% c(&quot;highlights&quot;,&quot;highlight&quot;, &quot;page&quot;, 
                      &quot;location&quot;, &quot;yellow&quot;, &quot;pink&quot;, &quot;orange&quot;, &quot;blue&quot;))
}

sentiment &lt;- list()
for (i in 1:28){
sentiment[[i]] &lt;- books[[i]] %&gt;%
        left_join(get_sentiments(&quot;nrc&quot;)) %&gt;%
        filter(!is.na(sentiment)) %&gt;%
        count(sentiment, sort = TRUE)
        print(book_names[i])
        print(sentiment[[i]])
}</code></pre>
<pre><code>## [1] &quot;Thinking, Fast and Slow&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       450
##  2 trust          256
##  3 negative       254
##  4 anticipation   163
##  5 fear           153
##  6 sadness        116
##  7 joy            107
##  8 anger          104
##  9 disgust         81
## 10 surprise        75
## [1] &quot;Influence: The Psychology of Persuasion (Collins Business Essentials)&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive        53
##  2 trust           37
##  3 joy             15
##  4 negative        15
##  5 fear            12
##  6 anticipation    11
##  7 sadness          8
##  8 anger            7
##  9 surprise         3
## 10 disgust          2
## [1] &quot;On Writing Well, 30th Anniversary Edition: An Informal Guide to Writing Nonfiction&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       172
##  2 negative        98
##  3 trust           81
##  4 anticipation    63
##  5 anger           48
##  6 fear            47
##  7 disgust         42
##  8 sadness         42
##  9 joy             37
## 10 surprise        26
## [1] &quot;Wired for Story: The Writer&#39;s Guide to Using Brain Science to Hook Readers from the Very First Sentence&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       413
##  2 negative       197
##  3 trust          178
##  4 anticipation   168
##  5 fear           152
##  6 joy            116
##  7 sadness        108
##  8 anger           96
##  9 surprise        84
## 10 disgust         41
## [1] &quot;Bird by Bird: Some Instructions on Writing and Life&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive        77
##  2 negative        55
##  3 anticipation    40
##  4 trust           38
##  5 joy             37
##  6 fear            30
##  7 sadness         27
##  8 disgust         17
##  9 surprise        16
## 10 anger           15
## [1] &quot;Atomic Habits: An Easy and Proven Way to Build Good Habits and Break Bad Ones&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       835
##  2 trust          455
##  3 anticipation   439
##  4 negative       356
##  5 joy            296
##  6 fear           254
##  7 sadness        180
##  8 anger          147
##  9 surprise       139
## 10 disgust        117
## [1] &quot;Storynomics: Story-Driven Marketing in the Post-Advertising World&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       860
##  2 trust          405
##  3 negative       364
##  4 anticipation   335
##  5 joy            250
##  6 fear           221
##  7 sadness        171
##  8 anger          167
##  9 surprise       166
## 10 disgust         76
## [1] &quot;Crucial Conversations Tools for Talking When Stakes Are High, Second Edition&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       758
##  2 negative       496
##  3 trust          412
##  4 fear           282
##  5 anticipation   258
##  6 anger          243
##  7 joy            216
##  8 sadness        196
##  9 disgust        142
## 10 surprise       108
## [1] &quot;Pre-Suasion: A Revolutionary Way to Influence and Persuade&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive        84
##  2 trust           51
##  3 negative        31
##  4 anticipation    27
##  5 fear            24
##  6 joy             22
##  7 anger           14
##  8 sadness         12
##  9 surprise         9
## 10 disgust          3
## [1] &quot;Made to Stick: Why some ideas take hold and others come unstuck&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       499
##  2 trust          236
##  3 anticipation   198
##  4 negative       167
##  5 joy            156
##  6 fear           123
##  7 surprise       107
##  8 sadness         74
##  9 anger           65
## 10 disgust         60
## [1] &quot;The Charisma Myth: Master the Art of Personal Magnetism&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       483
##  2 negative       254
##  3 trust          228
##  4 joy            166
##  5 anticipation   162
##  6 fear           157
##  7 sadness        143
##  8 anger          120
##  9 surprise        65
## 10 disgust         58
## [1] &quot;The Power of Moments: Why Certain Experiences Have Extraordinary Impact&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       294
##  2 trust          132
##  3 anticipation   123
##  4 negative       106
##  5 joy             96
##  6 fear            72
##  7 anger           52
##  8 surprise        50
##  9 sadness         45
## 10 disgust         19
## [1] &quot;Principles: Life and Work&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       313
##  2 trust          178
##  3 negative       129
##  4 anticipation   120
##  5 joy            103
##  6 sadness         80
##  7 fear            78
##  8 anger           53
##  9 surprise        50
## 10 disgust         35
## [1] &quot;Deep Work: Rules for Focused Success in a Distracted World&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       176
##  2 trust           69
##  3 anticipation    54
##  4 negative        36
##  5 joy             32
##  6 fear            19
##  7 sadness         14
##  8 surprise        14
##  9 anger           12
## 10 disgust          7
## [1] &quot;Getting to Yes: Negotiating an agreement without giving in&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       444
##  2 trust          234
##  3 negative       180
##  4 anticipation   135
##  5 anger          103
##  6 fear           100
##  7 joy             83
##  8 sadness         68
##  9 surprise        48
## 10 disgust         38
## [1] &quot;Who: The A Method for Hiring&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       259
##  2 trust          125
##  3 anticipation    95
##  4 joy             73
##  5 negative        68
##  6 fear            30
##  7 surprise        29
##  8 anger           25
##  9 sadness         22
## 10 disgust         16
## [1] &quot;Mindset: Changing The Way You think To Fulfil Your Potential&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       317
##  2 trust          160
##  3 negative       134
##  4 joy            117
##  5 anticipation   100
##  6 fear            78
##  7 anger           70
##  8 sadness         65
##  9 disgust         57
## 10 surprise        44
## [1] &quot;The 4-Hour Work Week: Escape the 9-5, Live Anywhere and Join the New Rich&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       131
##  2 anticipation    70
##  3 negative        64
##  4 trust           57
##  5 joy             56
##  6 fear            34
##  7 surprise        27
##  8 anger           24
##  9 sadness         20
## 10 disgust         14
## [1] &quot;Tools of Titans: The Tactics, Routines, and Habits of Billionaires, Icons, and World-Class Performers&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       406
##  2 negative       251
##  3 trust          199
##  4 anticipation   188
##  5 fear           134
##  6 joy            126
##  7 anger          111
##  8 sadness        108
##  9 surprise        78
## 10 disgust         74
## [1] &quot;The Elements of Eloquence: How to Turn the Perfect English Phrase&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive        18
##  2 negative        13
##  3 fear             9
##  4 trust            9
##  5 joy              6
##  6 sadness          6
##  7 anger            5
##  8 anticipation     3
##  9 disgust          2
## 10 surprise         2
## [1] &quot;The One Thing: The Surprisingly Simple Truth Behind Extraordinary Results: Achieve your goals with one of the world&#39;s bestselling success books (Basic Skills)&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       139
##  2 anticipation    97
##  3 trust           60
##  4 joy             56
##  5 negative        32
##  6 fear            20
##  7 anger           14
##  8 surprise        14
##  9 disgust          9
## 10 sadness          9
## [1] &quot;How to Win Friends and Influence People&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive        33
##  2 trust           14
##  3 negative        11
##  4 anticipation    10
##  5 joy              7
##  6 anger            6
##  7 fear             5
##  8 surprise         5
##  9 disgust          4
## 10 sadness          4
## [1] &quot;The Untethered Soul: The Journey Beyond Yourself&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       353
##  2 negative       251
##  3 fear           183
##  4 anticipation   172
##  5 trust          158
##  6 joy            156
##  7 sadness        137
##  8 anger          125
##  9 surprise        65
## 10 disgust         56
## [1] &quot;Man&#39;s Search For Meaning: The classic tribute to hope from the Holocaust&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       199
##  2 negative       172
##  3 fear           108
##  4 sadness        100
##  5 trust           97
##  6 anticipation    93
##  7 joy             77
##  8 anger           62
##  9 disgust         56
## 10 surprise        33
## [1] &quot;The Power of your Subconscious Mind and Other Works&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       183
##  2 joy            110
##  3 trust          110
##  4 anticipation    74
##  5 negative        59
##  6 anger           43
##  7 fear            38
##  8 sadness         29
##  9 surprise        26
## 10 disgust         22
## [1] &quot;Ego is the Enemy: The Fight to Master Our Greatest Opponent&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       206
##  2 trust          109
##  3 negative        97
##  4 anticipation    85
##  5 joy             79
##  6 fear            59
##  7 anger           54
##  8 sadness         42
##  9 disgust         37
## 10 surprise        31
## [1] &quot;Outliers: The Story of Success&quot;
## # A tibble: 7 x 2
##   sentiment        n
##   &lt;chr&gt;        &lt;int&gt;
## 1 positive        24
## 2 trust           11
## 3 joy              5
## 4 anticipation     4
## 5 fear             3
## 6 surprise         3
## 7 sadness          1
## [1] &quot;The Start-up of You: Adapt to the Future, Invest in Yourself, and Transform Your Career&quot;
## # A tibble: 10 x 2
##    sentiment        n
##    &lt;chr&gt;        &lt;int&gt;
##  1 positive       145
##  2 anticipation    79
##  3 trust           64
##  4 joy             42
##  5 negative        40
##  6 surprise        22
##  7 fear            21
##  8 sadness         17
##  9 anger           14
## 10 disgust          8</code></pre>
<pre class="r"><code>for (i in 1:28){
sentiment[[i]] %&gt;% 
    filter(sentiment %in% c(&#39;positive&#39;,&#39;negative&#39;)) %&gt;% 
    mutate( n2 = n/sum(n)) %&gt;% print()
  }</code></pre>
<pre><code>## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    450 0.639
## 2 negative    254 0.361
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive     53 0.779
## 2 negative     15 0.221
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    172 0.637
## 2 negative     98 0.363
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    413 0.677
## 2 negative    197 0.323
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive     77 0.583
## 2 negative     55 0.417
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    835 0.701
## 2 negative    356 0.299
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    860 0.703
## 2 negative    364 0.297
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    758 0.604
## 2 negative    496 0.396
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive     84 0.730
## 2 negative     31 0.270
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    499 0.749
## 2 negative    167 0.251
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    483 0.655
## 2 negative    254 0.345
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    294 0.735
## 2 negative    106 0.265
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    313 0.708
## 2 negative    129 0.292
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    176 0.830
## 2 negative     36 0.170
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    444 0.712
## 2 negative    180 0.288
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    259 0.792
## 2 negative     68 0.208
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    317 0.703
## 2 negative    134 0.297
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    131 0.672
## 2 negative     64 0.328
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    406 0.618
## 2 negative    251 0.382
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive     18 0.581
## 2 negative     13 0.419
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    139 0.813
## 2 negative     32 0.187
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive     33  0.75
## 2 negative     11  0.25
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    353 0.584
## 2 negative    251 0.416
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    199 0.536
## 2 negative    172 0.464
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    183 0.756
## 2 negative     59 0.244
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    206 0.680
## 2 negative     97 0.320
## # A tibble: 1 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive     24     1
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    145 0.784
## 2 negative     40 0.216</code></pre>
<pre class="r"><code>books &lt;- str_trunc(book_names, width=22)
all &lt;- list()
for (i in 1:28) {
all[[i]] &lt;- sentiment[[i]] %&gt;% filter(sentiment %in% c(&#39;positive&#39;,&#39;negative&#39;)) %&gt;% mutate(n2 = n/sum(n)) %&gt;% print()
}</code></pre>
<pre><code>## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    450 0.639
## 2 negative    254 0.361
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive     53 0.779
## 2 negative     15 0.221
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    172 0.637
## 2 negative     98 0.363
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    413 0.677
## 2 negative    197 0.323
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive     77 0.583
## 2 negative     55 0.417
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    835 0.701
## 2 negative    356 0.299
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    860 0.703
## 2 negative    364 0.297
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    758 0.604
## 2 negative    496 0.396
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive     84 0.730
## 2 negative     31 0.270
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    499 0.749
## 2 negative    167 0.251
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    483 0.655
## 2 negative    254 0.345
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    294 0.735
## 2 negative    106 0.265
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    313 0.708
## 2 negative    129 0.292
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    176 0.830
## 2 negative     36 0.170
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    444 0.712
## 2 negative    180 0.288
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    259 0.792
## 2 negative     68 0.208
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    317 0.703
## 2 negative    134 0.297
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    131 0.672
## 2 negative     64 0.328
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    406 0.618
## 2 negative    251 0.382
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive     18 0.581
## 2 negative     13 0.419
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    139 0.813
## 2 negative     32 0.187
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive     33  0.75
## 2 negative     11  0.25
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    353 0.584
## 2 negative    251 0.416
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    199 0.536
## 2 negative    172 0.464
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    183 0.756
## 2 negative     59 0.244
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    206 0.680
## 2 negative     97 0.320
## # A tibble: 1 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive     24     1
## # A tibble: 2 x 3
##   sentiment     n    n2
##   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt;
## 1 positive    145 0.784
## 2 negative     40 0.216</code></pre>
<p>Positivty Map of the books.</p>
<pre class="r"><code>all_bound &lt;- do.call(&quot;rbind&quot;, all) %&gt;% filter(sentiment == &quot;positive&quot;)

library(ggrepel)
all_bound %&gt;% ggplot(aes(x= book_names, y=n2)) + 
  geom_point() + 
  geom_label_repel(aes(label=books, color = ifelse(n2 &lt;0.55, &quot;red&quot;, &quot;blue&quot;)), size = 3) +
  theme_classic() +
  theme(legend.position = &quot;none&quot;,
        text = element_text(size=18), 
        axis.text.x = element_blank()) + 
  xlab(&quot;Books&quot;) + 
  ylab(&quot;Positivity score&quot;)</code></pre>
<p><img src="/post/2019-12-13-an-accidental-side-effect-of-text-mining_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Let‚Äôs look at the book with the lowest positivity score. <strong>‚ÄúMan‚Äôs search for meaning‚Äù.</strong> This <a href="https://www.amazon.com/Mans-Search-Meaning-Viktor-Frankl/dp/080701429X">book</a> is based on Victor Frankl sufferings during the second world war. This is also kind of expected.</p>
<blockquote>
<p>I am getting more and more convinced text mining is giving good insights.</p>
</blockquote>
<p>The book ‚ÄúThe Outliers‚Äù appeared on the top of the positivity plot was a real outlier here. üòÆ</p>
<p>It is hard to know everything from the beginning and we will go back to make some additional cleaning. The word count from the book ‚ÄúThe Outliers‚Äù is 107. This is really low. So in the next iteration, I would remove it from the analysis since it will not be reliable.</p>
<pre class="r"><code>book_names[[27]]</code></pre>
<pre><code>## [1] &quot;Outliers: The Story of Success&quot;</code></pre>
<pre class="r"><code>top[[27]]</code></pre>
<pre><code>## # A tibble: 105 x 2
## # Groups:   word [105]
##    word             n
##    &lt;chr&gt;        &lt;int&gt;
##  1 ability          3
##  2 knowing          3
##  3 sense            3
##  4 communicate      2
##  5 distance         2
##  6 family           2
##  7 intelligence     2
##  8 power            2
##  9 practical        2
## 10 sternberg        2
## # ... with 95 more rows</code></pre>
<p>The word count from the book ‚ÄúThe Outliers‚Äù below is 107. This is really low. So in the next iteration, I would remove it from the analysis since it will not be very informative. It is hard to know everything from the beginning and we will go back and make some additional cleaning.</p>
<p>‚Ä¶</p>
<div id="summary" class="section level3">
<h3>Summary</h3>
<p>It is not feasible to read millions of pages to check whether text mining is reliable. But here I got some data that I know the content and I applied text mining approaches and sentiment analysis.</p>
<p>Both the monograms or bigrams pointed to similar ideas what the books were about. And the sentiments made sense with the genres of the books in my kindle.</p>
<p>Let‚Äôs come back to our hacker.</p>
<p>An unanticipated side effect of text mining changed him forever. Analyzing my books and gaining the insights made him more and more interested in reading. And he started to care about the world around him. The world was different.</p>
<p>What I was trying to do for myself, he did for himself. He transformed into a better version of himself.</p>
<p>The world was brighter. ‚òÄÔ∏è</p>
<p>The radio disrupted the silence.</p>
<blockquote>
<p>‚Äúbrrring‚Ä¶..brrring‚Ä¶..brrring‚Ä¶..‚Äù</p>
</blockquote>
<p>I woke up.</p>
<p>‚Ä¶</p>
<p>Thank you for reading. I hope you‚Äôve learned something or got inspiration from this. Please feel free to leave comments, suggestions, and questions. (You can always contact me by email at <a href="mailto:serdar.korur@gmail.com" class="email">serdar.korur@gmail.com</a>)</p>
<p>You can find the data and the code in my <a href="https://github.com/korur/textmining">github</a>.</p>
<p>Until next time!</p>
<p>Serdar</p>
</div>

    </div>

    


    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/texmining/">texmining</a>
  
  <a class="badge badge-light" href="/tags/nlp/">nlp</a>
  
  <a class="badge badge-light" href="/tags/sentimentanalysis/">sentimentanalysis</a>
  
  <a class="badge badge-light" href="/tags/kindle/">kindle</a>
  
</div>



    
      








  






  
  
  
    
  
  
  <div class="media author-card">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu96621ee6091813445ab589d945e63a4a_591724_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Serdar Korur</a></h5>
      <h6 class="card-subtitle">Data Scientist</h6>
      <p class="card-text">Serdar is a Data Scientist and PhD in Cell Biology</p>
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
          <li>
            <a href="mailto:serdar.korur@gmail.com" >
              <i class="fas fa-envelope"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a href="https://github.com/korur/" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a href="https://www.linkedin.com/in/serdar-korur/" target="_blank" rel="noopener">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a href="https://medium.com/@serdarkorur" target="_blank" rel="noopener">
              <i class="fab fa-medium"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
    

    

    
<section id="comments">
  
    
<div id="disqus_thread"></div>
<script>
  let disqus_config = function () {
    
    
    
  };
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); s.async = true;
    s.src = 'https://' + "serdarkorur" + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  
</section>



  </div>
</article>

      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    <script id="dsq-count-scr" src="https://serdarkorur.disqus.com/count.js" async></script>
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.130521ecfc6f534c52c158217bbff718.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
        
  </p>
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
